<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Sanierungsrechner – BAFA & KfW (V2.2)</title>

<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#fafafa;margin:0}
.wrap{max-width:1100px;margin:24px auto;padding:0 16px}
.card{background:#fff;border:1px solid #e6e8eb;border-radius:16px;padding:16px;margin-bottom:12px}
h1{font-size:22px;margin:0 0 6px}
h2{font-size:16px;margin:0 0 10px}
.small{font-size:12px;color:#60646c}
.muted{color:#60646c;font-size:13px}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
.col4{grid-column:span 4}
.col6{grid-column:span 6}
.col12{grid-column:span 12}
@media(max-width:900px){.col4,.col6{grid-column:span 12}}
input,select{width:100%;padding:10px;border:1px solid #d9dde3;border-radius:12px}
.btn{background:#111;color:#fff;border:0;border-radius:12px;padding:10px 14px;font-weight:600;cursor:pointer}
.btn.secondary{background:#fff;color:#111;border:1px solid #d9dde3}
.hidden{display:none}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #e6e8eb;font-size:13px}
th{background:#f4f6f8;text-align:left}
.right{text-align:right}
.ok{background:#effff5;border:1px solid #bff0d0;border-radius:14px;padding:12px}
.warn{background:#fff6e5;border:1px solid #ffe0a3;border-radius:14px;padding:12px}
</style>
</head>

<body>
<div class="wrap">

<div class="card">
<h1>Sanierungsrechner</h1>
<p class="muted">Grobe Kosten- & Förderindikation (BAFA / KfW) – keine Förderzusage.</p>
</div>

<!-- STEP 1 -->
<div class="card">
<h2>1️⃣ Gebäude & Förderoptionen</h2>
<div class="grid">

<div class="col4">
<label>Baujahr</label>
<select id="baujahr">
<option value="bis_1978">bis 1978</option>
<option value="1979_1994">1979–1994</option>
<option value="1995_2009">1995–2009</option>
<option value="ab_2010">ab 2010</option>
</select>
</div>

<div class="col4">
<label>Wohnfläche (m²)</label>
<input id="wf" value="140">
</div>

<div class="col4">
<label>Energieträger</label>
<select id="fuel">
<option value="gas">Erdgas</option>
<option value="oil">Heizöl</option>
<option value="district">Fernwärme</option>
</select>
</div>

<div class="col6">
<label>Förderungen berücksichtigen?</label>
<select id="fundingMode">
<option value="no">Nein</option>
<option value="yes">Ja</option>
</select>
</div>

<div class="col6 hidden" id="isfpWrap">
<label>iSFP vorhanden? (+5 % BAFA)</label>
<select id="isfp">
<option value="no">Nein</option>
<option value="yes">Ja</option>
</select>
</div>

<div class="col6 hidden" id="kfwWrap">
<label>Heizung über KfW fördern?</label>
<select id="kfw">
<option value="no">Nein</option>
<option value="yes">Ja</option>
</select>
</div>

</div>
</div>

<!-- STEP 2 -->
<div class="card">
<h2>2️⃣ Maßnahmen</h2>
<div class="grid">
<div class="col6"><label><input type="checkbox" value="heat"> Heizung tauschen</label></div>
<div class="col6"><label><input type="checkbox" value="facade"> Fassade dämmen</label></div>
<div class="col6"><label><input type="checkbox" value="roof"> Dach / oberste Geschossdecke</label></div>
<div class="col6"><label><input type="checkbox" value="windows"> Fenster erneuern</label></div>
<div class="col6"><label><input type="checkbox" value="basement"> Kellerdecke dämmen</label></div>
</div>
</div>

<!-- STEP 3 -->
<div class="card">
<button class="btn" id="calcBtn">Ergebnis anzeigen</button>
</div>

<!-- RESULT -->
<div class="card hidden" id="result">
<h2>Ergebnis (Indikation)</h2>

<div class="grid">
<div class="col4 ok">
<div class="small">Investition brutto</div>
<b id="invBrutto"></b>
</div>

<div class="col4 ok">
<div class="small">Förderung gesamt</div>
<b id="fundSum"></b>
</div>

<div class="col4 ok">
<div class="small">Investition netto</div>
<b id="invNetto"></b>
</div>
</div>

<table style="margin-top:12px">
<thead>
<tr><th>Maßnahme</th><th class="right">Brutto</th><th class="right">Förderung</th><th class="right">Netto</th></tr>
</thead>
<tbody id="rows"></tbody>
</table>

<div class="warn" style="margin-top:12px">
<b>Förderannahmen:</b><br>
• BAFA: 15 % (+5 % iSFP, falls vorhanden)<br>
• KfW Heizung: 30–70 % (indikativ)<br>
• Keine Förderzusage
</div>
</div>

</div>

<script>
const costs={
  heat:22000,
  facade:24000,
  roof:18000,
  windows:16000,
  basement:9000
};

function eur(x){
  return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(x);
}

function bafaRate(hasIsfp){
  return hasIsfp ? 0.20 : 0.15;
}

const kfwRates={min:0.30,typ:0.50,max:0.70};

fundingMode.onchange=()=>{
  isfpWrap.classList.toggle("hidden",fundingMode.value!=="yes");
  kfwWrap.classList.toggle("hidden",fundingMode.value!=="yes");
};

calcBtn.onclick=()=>{
  const checked=[...document.querySelectorAll('input[type="checkbox"]:checked')].map(x=>x.value);
  if(!checked.length){alert("Bitte Maßnahme wählen");return;}

  let brutto=0, foerder=0;
  rows.innerHTML="";

  checked.forEach(m=>{
    const c=costs[m];
    let f=0;

    if(fundingMode.value==="yes"){
      if(m==="heat" && kfw.value==="yes"){
        f=c*kfwRates.typ;
      }else{
        f=c*bafaRate(isfp.value==="yes");
      }
    }

    brutto+=c;
    foerder+=f;

    rows.innerHTML+=`<tr>
      <td>${m}</td>
      <td class="right">${eur(c)}</td>
      <td class="right">${eur(f)}</td>
      <td class="right">${eur(c-f)}</td>
    </tr>`;
  });

  invBrutto.textContent=eur(brutto);
  fundSum.textContent=eur(foerder);
  invNetto.textContent=eur(brutto-foerder);
  result.classList.remove("hidden");
};
</script>

</body>
</html>
